<!DOCTYPE html>
<html lang="en-gb">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>OSGS - Postgres and PostGIS</title>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css" integrity="sha256-NuCn4IvuZXdBaFKJOAcsU2Q3ZpwbdFisd5dux4jkQ5w=" crossorigin="anonymous"/>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous"/>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap-theme.css" integrity="sha256-xOpS+e/dER8z72w+qryCieOGysQI8cELAVt3MHG0phY=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tooltipster@4.2.7/dist/css/tooltipster.bundle.min.css" integrity="sha256-Qc4lCfqZWYaHF5hgEOFrYzSIX9Rrxk0NPHRac+08QeQ=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tooltipster@4.2.7/dist/css/plugins/tooltipster/sideTip/themes/tooltipster-sideTip-light.min.css" integrity="sha256-Wa1I4jhSXeWd3N6RhfPlkqr1WlT+zS3Vh2YGCg0129E=" crossorigin="anonymous">
<link href="https://fonts.googleapis.com/css?family=Open+Sans|Source+Code+Pro|Source+Sans+Pro|Source+Serif+Pro|Roboto|Roboto+Mono" rel="stylesheet">
<link href="https://fonts.red-dove.com/iosevka-ss09-regular/webfont.css" rel="stylesheet">

    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/css/sizzle.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/css/sizzle.css" type="text/css" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.9.1/underscore-min.js" integrity="sha256-G7A4JrJjJlFqP0yamznwPjAApIKPkadeHfyIwiaa9e0=" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/tooltipster@4.2.7/dist/js/tooltipster.bundle.min.js" integrity="sha256-NOU7KrY2aTI4PxDegqYUIknk9qfxVCS0E4JfE9aMwaA=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  false,
        SOURCELINK_SUFFIX: '.txt'
      };
      $(document).data('sizzle', {on_load: []});
    </script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
      <script src="../../app-data.js"></script>
<link rel="index" title="Index" href="../genindex.html" />
<link rel="search" title="Search" href="../search.html" />
<link rel="next" title="GeoServer" href="geoserver.html" />
<link rel="prev" title="Services" href="index.html" />

</head>
<body class="full-height test">
<noscript>
  <div>
    <div id="noscript-message">JavaScript is not enabled. It is needed for this website to work.</div>
  </div>
</noscript>
<div id="whole-page" class="container-fluid content full-height">
  <div id="header-row" class="row">
    <div id="header-container" class="col-md-12">
      <div id="hdr-left">
        <i class="fa fa-bars menu-toggle"></i>
        
<a href="../index.html" class="text-logo">OSGS 0.1 documentation</a>

      </div>
      <div id="hdr-centre" class="text-center stretch">
        <h3 title="Postgres and PostGIS">Postgres and PostGIS</h3>
        <h6>Postgres and PostGIS</h6>
      </div>
      <div id="hdr-search">
        
<div class="input-group" title="Enter something to search for and then either press Enter or click the magnifying glass">
  <input type="text" class="form-control search-query" placeholder="Search docs ...">
  <div class="input-group-addon">
    <i class="fa fa-search"></i>
  </div>
</div>
      </div>

      <div id="hdr-index">
        <a href="../genindex.html" class="btn btn-default" title="Go to the index"><i class="fa fa-list"></i></a>
      </div>

      <div id="hdr-source">
        <a href="../_sources/services/postgres.md.txt" class="btn btn-default" title="See the source for this page"><i class="fa fa-code"></i></a>
      </div>

      <div id="hdr-right">
        
  
  <div class="prev-next">
    
      <div class="pull-left">
        <a class="btn btn-default prev" href="index.html" title="Previous chapter (Services)"><i class="fa fa-chevron-left mr-1em" aria-hidden="true"></i><span class="btn-text">Services</span></a>
      </div>
    
      <div class="pull-right">
        <a class="btn btn-default next" href="geoserver.html" title="Next chapter (GeoServer)"><span class="btn-text">GeoServer</span>&nbsp;<i class="fa fa-chevron-right ml-1em" aria-hidden="true"></i></a>
      </div>
    </div>
  
      </div>
      <div id="alt-hdr-right">

        <a href="index.html"><i class="fa fa-chevron-left mr-8"></i></a>


        <a href="../index.html"><i class="fa fa-home mr-8"></i></a>


        <a href="../search.html"><i class="fa fa-search mr-8"></i></a>


        <a href="../genindex.html"><i class="fa fa-list mr-8"></i></a>


        <a href="geoserver.html"><i class="fa fa-chevron-right"></i></a>

      </div>
    </div>
  </div>

  <div id="content-row" class="row">
    <div id="page-content" class="col-md-12 flex-col">
      <div id="content-container">
        <div id="nav">
          
  <div class="navsidebar">
    <div id="sidebar-search">
      
<div class="input-group" title="Enter something to search for and then either press Enter or click the magnifying glass">
  <input type="text" class="form-control search-query" placeholder="Search docs ...">
  <div class="input-group-addon">
    <i class="fa fa-search"></i>
  </div>
</div>
    </div>
      <div class="sidebar-block">
        <div class="sidebar-tocheading">
          <div class="pull-left">
            <h2>Table Of Contents</h2>
          </div>
          <div class="pull-right" title="Hide this sidebar (hover at left edge to bring it back)"><i class="fa fa-chevron-left hidetoc"></i></div>
        </div>
        <div class="sidebar-toc">
      
          <div id="toc-filter" title="Type in here to show only matching topics">
            <input class="form-control" id="toc-filter-query" placeholder="Filter by title ...">
          </div>
      
        
  
    <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html#introduction">Introduction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../introduction.html#what-is-the-open-source-gis-stack"><strong>What is the Open Source GIS Stack?</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction.html#overview-diagram">Overview Diagram</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html#osgs">Services</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#postgres-and-postgis">Postgres and PostGIS</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#configuration">Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="#deployment">Deployment</a></li>
<li class="toctree-l3"><a class="reference internal" href="#enabling">Enabling</a></li>
<li class="toctree-l3"><a class="reference internal" href="#disabling">Disabling</a></li>
<li class="toctree-l3"><a class="reference internal" href="#accessing-the-running-services">Accessing the running services</a></li>
<li class="toctree-l3"><a class="reference internal" href="#additional-notes">Additional Notes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id1">Configuration</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#database-password">Database password:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#service-file-configuration">Service file configuration:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id2">Deployment</a></li>
<li class="toctree-l4"><a class="reference internal" href="#validation">Validation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#postgresql-workflows">PostgreSQL Workflows</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#direct-connection">Direct connection</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="geoserver.html">GeoServer</a><ul>
<li class="toctree-l3"><a class="reference internal" href="geoserver.html#configuration">Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="geoserver.html#deployment">Deployment</a></li>
<li class="toctree-l3"><a class="reference internal" href="geoserver.html#enabling">Enabling</a></li>
<li class="toctree-l3"><a class="reference internal" href="geoserver.html#disabling">Disabling</a></li>
<li class="toctree-l3"><a class="reference internal" href="geoserver.html#accessing-the-running-services">Accessing the running services</a></li>
<li class="toctree-l3"><a class="reference internal" href="geoserver.html#additional-notes">Additional Notes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="hugo-watcher.html">Hugo Watcher</a><ul>
<li class="toctree-l3"><a class="reference internal" href="hugo-watcher.html#configuration">Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="hugo-watcher.html#deployment">Deployment</a></li>
<li class="toctree-l3"><a class="reference internal" href="hugo-watcher.html#enabling">Enabling</a></li>
<li class="toctree-l3"><a class="reference internal" href="hugo-watcher.html#disabling">Disabling</a></li>
<li class="toctree-l3"><a class="reference internal" href="hugo-watcher.html#accessing-the-running-services">Accessing the running services</a></li>
<li class="toctree-l3"><a class="reference internal" href="hugo-watcher.html#additional-notes">Additional Notes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="lizmap.html">Lizmap</a><ul>
<li class="toctree-l3"><a class="reference internal" href="lizmap.html#configuration">Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="lizmap.html#deployment">Deployment</a></li>
<li class="toctree-l3"><a class="reference internal" href="lizmap.html#enabling">Enabling</a></li>
<li class="toctree-l3"><a class="reference internal" href="lizmap.html#disabling">Disabling</a></li>
<li class="toctree-l3"><a class="reference internal" href="lizmap.html#accessing-the-running-services">Accessing the running services</a></li>
<li class="toctree-l3"><a class="reference internal" href="lizmap.html#additional-notes">Additional Notes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="mergin-server.html">Mergin Server</a><ul>
<li class="toctree-l3"><a class="reference internal" href="mergin-server.html#configuration">Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="mergin-server.html#deployment">Deployment</a></li>
<li class="toctree-l3"><a class="reference internal" href="mergin-server.html#enabling">Enabling</a></li>
<li class="toctree-l3"><a class="reference internal" href="mergin-server.html#disabling">Disabling</a></li>
<li class="toctree-l3"><a class="reference internal" href="mergin-server.html#accessing-the-running-services">Accessing the running services</a></li>
<li class="toctree-l3"><a class="reference internal" href="mergin-server.html#additional-notes">Additional Notes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="mergin-client.html">Mergin Client</a><ul>
<li class="toctree-l3"><a class="reference internal" href="mergin-client.html#configuration">Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="mergin-client.html#deployment">Deployment</a></li>
<li class="toctree-l3"><a class="reference internal" href="mergin-client.html#enabling">Enabling</a></li>
<li class="toctree-l3"><a class="reference internal" href="mergin-client.html#disabling">Disabling</a></li>
<li class="toctree-l3"><a class="reference internal" href="mergin-client.html#accessing-the-running-services">Accessing the running services</a></li>
<li class="toctree-l3"><a class="reference internal" href="mergin-client.html#additional-notes">Additional Notes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="mergin-db-sync.html">Mergin-db-sync</a><ul>
<li class="toctree-l3"><a class="reference internal" href="mergin-db-sync.html#configuration">Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="mergin-db-sync.html#deployment">Deployment</a></li>
<li class="toctree-l3"><a class="reference internal" href="mergin-db-sync.html#enabling">Enabling</a></li>
<li class="toctree-l3"><a class="reference internal" href="mergin-db-sync.html#disabling">Disabling</a></li>
<li class="toctree-l3"><a class="reference internal" href="mergin-db-sync.html#accessing-the-running-services">Accessing the running services</a></li>
<li class="toctree-l3"><a class="reference internal" href="mergin-db-sync.html#additional-notes">Additional Notes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="nginx.html">Nginx</a><ul>
<li class="toctree-l3"><a class="reference internal" href="nginx.html#configuration">Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="nginx.html#deployment">Deployment</a></li>
<li class="toctree-l3"><a class="reference internal" href="nginx.html#enabling">Enabling</a></li>
<li class="toctree-l3"><a class="reference internal" href="nginx.html#disabling">Disabling</a></li>
<li class="toctree-l3"><a class="reference internal" href="nginx.html#accessing-the-running-services">Accessing the running services</a></li>
<li class="toctree-l3"><a class="reference internal" href="nginx.html#additional-notes">Additional Notes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="postgrest.html">PostgREST</a><ul>
<li class="toctree-l3"><a class="reference internal" href="postgrest.html#configuration">Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="postgrest.html#deployment">Deployment</a></li>
<li class="toctree-l3"><a class="reference internal" href="postgrest.html#enabling">Enabling</a></li>
<li class="toctree-l3"><a class="reference internal" href="postgrest.html#disabling">Disabling</a></li>
<li class="toctree-l3"><a class="reference internal" href="postgrest.html#accessing-the-running-services">Accessing the running services</a></li>
<li class="toctree-l3"><a class="reference internal" href="postgrest.html#additional-notes">Additional Notes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="qgis-server.html">QGIS Server</a><ul>
<li class="toctree-l3"><a class="reference internal" href="qgis-server.html#configuration">Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="qgis-server.html#deployment">Deployment</a></li>
<li class="toctree-l3"><a class="reference internal" href="qgis-server.html#enabling">Enabling</a></li>
<li class="toctree-l3"><a class="reference internal" href="qgis-server.html#disabling">Disabling</a></li>
<li class="toctree-l3"><a class="reference internal" href="qgis-server.html#accessing-the-running-services">Accessing the running services</a></li>
<li class="toctree-l3"><a class="reference internal" href="qgis-server.html#additional-notes">Additional Notes</a></li>
<li class="toctree-l3"><a class="reference internal" href="qgis-server.html#further-reading">Further Reading</a></li>
<li class="toctree-l3"><a class="reference internal" href="qgis-server.html#qgis-server-atlas-print-plugin">QGIS Server Atlas Print Plugin</a></li>
<li class="toctree-l3"><a class="reference internal" href="qgis-server.html#qgis-server-scaling">QGIS Server Scaling</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="scp.html">SCP</a><ul>
<li class="toctree-l3"><a class="reference internal" href="scp.html#configuration">Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="scp.html#deployment">Deployment</a></li>
<li class="toctree-l3"><a class="reference internal" href="scp.html#enabling">Enabling</a></li>
<li class="toctree-l3"><a class="reference internal" href="scp.html#disabling">Disabling</a></li>
<li class="toctree-l3"><a class="reference internal" href="scp.html#accessing-the-running-services">Accessing the running services</a></li>
<li class="toctree-l3"><a class="reference internal" href="scp.html#additional-notes">Additional Notes</a></li>
<li class="toctree-l3"><a class="reference internal" href="scp.html#scp-file-drop-shares">SCP File Drop Shares</a></li>
<li class="toctree-l3"><a class="reference internal" href="scp.html#directory-layout-for-the-qgis-projects-folder">Directory layout for the QGIS projects folder</a></li>
<li class="toctree-l3"><a class="reference internal" href="scp.html#starting-the-container">Starting the container</a></li>
<li class="toctree-l3"><a class="reference internal" href="scp.html#faq">FAQ</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="index.html#indices-and-tables">Indices and tables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation/index.html#installation">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../installation/server_preparation.html#preparing-the-server">Preparing the server</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../installation/server_preparation.html#basic-security">Basic Security</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../installation/server_preparation.html#unattended-upgrades">Unattended upgrades</a></li>
<li class="toctree-l4"><a class="reference internal" href="../installation/server_preparation.html#ssh">ssh</a></li>
<li class="toctree-l4"><a class="reference internal" href="../installation/server_preparation.html#crowdsec">Crowdsec</a></li>
<li class="toctree-l4"><a class="reference internal" href="../installation/server_preparation.html#fail2ban">Fail2ban</a></li>
<li class="toctree-l4"><a class="reference internal" href="../installation/server_preparation.html#firewall">Firewall</a></li>
<li class="toctree-l4"><a class="reference internal" href="../installation/server_preparation.html#status-monitoring">Status monitoring</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../installation/server_preparation.html#additional-software">Additional Software</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../installation/server_preparation.html#docker">Docker</a></li>
<li class="toctree-l4"><a class="reference internal" href="../installation/server_preparation.html#git-rpl-pwgen-and-make-openssl">Git, rpl, pwgen and Make. openssl</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../installation/initial_configuration.html#initial-configuration">Initial Configuration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../installation/initial_configuration.html#user-group">User Group</a></li>
<li class="toctree-l3"><a class="reference internal" href="../installation/initial_configuration.html#project-checkout">Project Checkout</a></li>
<li class="toctree-l3"><a class="reference internal" href="../installation/initial_configuration.html#fetching-docker-images">Fetching Docker Images</a></li>
<li class="toctree-l3"><a class="reference internal" href="../installation/initial_configuration.html#configuration">Configuration</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../installation/fonts.html#obtaining-free-fonts-for-your-projects">Obtaining free fonts for your projects</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation/production_stack.html#production-stack">Production Stack</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../installation/production_stack.html#overview">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="../installation/production_stack.html#configuration">Configuration</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../installation/index.html#indices-and-tables">Indices and tables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../utilities/index.html">Utilities</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../utilities/make-ps.html">make ps</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../utilities/make-ps.html#synopsis">Synopsis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../utilities/make-ps.html#usage">Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../utilities/make-ps.html#notes">Notes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../utilities/make-kill.html">make kill</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../utilities/make-kill.html#synopsis">Synopsis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../utilities/make-kill.html#usage">Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../utilities/make-kill.html#notes">Notes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../utilities/make-nuke.html">make nuke</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../utilities/make-nuke.html#synopsis">Synopsis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../utilities/make-nuke.html#usage">Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../utilities/make-nuke.html#notes">Notes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../utilities/building_docs.html">Building Documentation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../utilities/building_docs.html#html-docs">HTML Docs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../utilities/building_docs.html#pdf-docs">PDF Docs</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../utilities/index.html#indices-and-tables">Indices and tables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../workflows/index.html">Workdlows</a><ul class="simple">
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../workflows/index.html#indices-and-tables">Indices and tables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../osm.html#osm-mirror">OSM Mirror</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../osm.html#pbf-container">PBF Container</a></li>
<li class="toctree-l2"><a class="reference internal" href="../osm.html#clip-area">Clip Area</a></li>
<li class="toctree-l2"><a class="reference internal" href="../osm.html#mappings">Mappings</a></li>
<li class="toctree-l2"><a class="reference internal" href="../osm.html#run-services">Run services</a></li>
<li class="toctree-l2"><a class="reference internal" href="../osm.html#publishing-with-geoserver">Publishing with GeoServer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../osm.html#publishing-with-qgis-server">Publishing with QGIS Server</a></li>
<li class="toctree-l2"><a class="reference internal" href="../osm.html#osm-attribution">OSM Attribution</a></li>
</ul>
</li>
</ul>

  
        </div>
      </div>
  </div>
        </div>
        <div id="content" tabindex="0" class="stretch">
          <div id="mnav">
            
  
    <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html#introduction">Introduction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../introduction.html#what-is-the-open-source-gis-stack"><strong>What is the Open Source GIS Stack?</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction.html#overview-diagram">Overview Diagram</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html#osgs">Services</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#postgres-and-postgis">Postgres and PostGIS</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#configuration">Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="#deployment">Deployment</a></li>
<li class="toctree-l3"><a class="reference internal" href="#enabling">Enabling</a></li>
<li class="toctree-l3"><a class="reference internal" href="#disabling">Disabling</a></li>
<li class="toctree-l3"><a class="reference internal" href="#accessing-the-running-services">Accessing the running services</a></li>
<li class="toctree-l3"><a class="reference internal" href="#additional-notes">Additional Notes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id1">Configuration</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#database-password">Database password:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#service-file-configuration">Service file configuration:</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id2">Deployment</a></li>
<li class="toctree-l4"><a class="reference internal" href="#validation">Validation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#postgresql-workflows">PostgreSQL Workflows</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#direct-connection">Direct connection</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="geoserver.html">GeoServer</a><ul>
<li class="toctree-l3"><a class="reference internal" href="geoserver.html#configuration">Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="geoserver.html#deployment">Deployment</a></li>
<li class="toctree-l3"><a class="reference internal" href="geoserver.html#enabling">Enabling</a></li>
<li class="toctree-l3"><a class="reference internal" href="geoserver.html#disabling">Disabling</a></li>
<li class="toctree-l3"><a class="reference internal" href="geoserver.html#accessing-the-running-services">Accessing the running services</a></li>
<li class="toctree-l3"><a class="reference internal" href="geoserver.html#additional-notes">Additional Notes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="hugo-watcher.html">Hugo Watcher</a><ul>
<li class="toctree-l3"><a class="reference internal" href="hugo-watcher.html#configuration">Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="hugo-watcher.html#deployment">Deployment</a></li>
<li class="toctree-l3"><a class="reference internal" href="hugo-watcher.html#enabling">Enabling</a></li>
<li class="toctree-l3"><a class="reference internal" href="hugo-watcher.html#disabling">Disabling</a></li>
<li class="toctree-l3"><a class="reference internal" href="hugo-watcher.html#accessing-the-running-services">Accessing the running services</a></li>
<li class="toctree-l3"><a class="reference internal" href="hugo-watcher.html#additional-notes">Additional Notes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="lizmap.html">Lizmap</a><ul>
<li class="toctree-l3"><a class="reference internal" href="lizmap.html#configuration">Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="lizmap.html#deployment">Deployment</a></li>
<li class="toctree-l3"><a class="reference internal" href="lizmap.html#enabling">Enabling</a></li>
<li class="toctree-l3"><a class="reference internal" href="lizmap.html#disabling">Disabling</a></li>
<li class="toctree-l3"><a class="reference internal" href="lizmap.html#accessing-the-running-services">Accessing the running services</a></li>
<li class="toctree-l3"><a class="reference internal" href="lizmap.html#additional-notes">Additional Notes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="mergin-server.html">Mergin Server</a><ul>
<li class="toctree-l3"><a class="reference internal" href="mergin-server.html#configuration">Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="mergin-server.html#deployment">Deployment</a></li>
<li class="toctree-l3"><a class="reference internal" href="mergin-server.html#enabling">Enabling</a></li>
<li class="toctree-l3"><a class="reference internal" href="mergin-server.html#disabling">Disabling</a></li>
<li class="toctree-l3"><a class="reference internal" href="mergin-server.html#accessing-the-running-services">Accessing the running services</a></li>
<li class="toctree-l3"><a class="reference internal" href="mergin-server.html#additional-notes">Additional Notes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="mergin-client.html">Mergin Client</a><ul>
<li class="toctree-l3"><a class="reference internal" href="mergin-client.html#configuration">Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="mergin-client.html#deployment">Deployment</a></li>
<li class="toctree-l3"><a class="reference internal" href="mergin-client.html#enabling">Enabling</a></li>
<li class="toctree-l3"><a class="reference internal" href="mergin-client.html#disabling">Disabling</a></li>
<li class="toctree-l3"><a class="reference internal" href="mergin-client.html#accessing-the-running-services">Accessing the running services</a></li>
<li class="toctree-l3"><a class="reference internal" href="mergin-client.html#additional-notes">Additional Notes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="mergin-db-sync.html">Mergin-db-sync</a><ul>
<li class="toctree-l3"><a class="reference internal" href="mergin-db-sync.html#configuration">Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="mergin-db-sync.html#deployment">Deployment</a></li>
<li class="toctree-l3"><a class="reference internal" href="mergin-db-sync.html#enabling">Enabling</a></li>
<li class="toctree-l3"><a class="reference internal" href="mergin-db-sync.html#disabling">Disabling</a></li>
<li class="toctree-l3"><a class="reference internal" href="mergin-db-sync.html#accessing-the-running-services">Accessing the running services</a></li>
<li class="toctree-l3"><a class="reference internal" href="mergin-db-sync.html#additional-notes">Additional Notes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="nginx.html">Nginx</a><ul>
<li class="toctree-l3"><a class="reference internal" href="nginx.html#configuration">Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="nginx.html#deployment">Deployment</a></li>
<li class="toctree-l3"><a class="reference internal" href="nginx.html#enabling">Enabling</a></li>
<li class="toctree-l3"><a class="reference internal" href="nginx.html#disabling">Disabling</a></li>
<li class="toctree-l3"><a class="reference internal" href="nginx.html#accessing-the-running-services">Accessing the running services</a></li>
<li class="toctree-l3"><a class="reference internal" href="nginx.html#additional-notes">Additional Notes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="postgrest.html">PostgREST</a><ul>
<li class="toctree-l3"><a class="reference internal" href="postgrest.html#configuration">Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="postgrest.html#deployment">Deployment</a></li>
<li class="toctree-l3"><a class="reference internal" href="postgrest.html#enabling">Enabling</a></li>
<li class="toctree-l3"><a class="reference internal" href="postgrest.html#disabling">Disabling</a></li>
<li class="toctree-l3"><a class="reference internal" href="postgrest.html#accessing-the-running-services">Accessing the running services</a></li>
<li class="toctree-l3"><a class="reference internal" href="postgrest.html#additional-notes">Additional Notes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="qgis-server.html">QGIS Server</a><ul>
<li class="toctree-l3"><a class="reference internal" href="qgis-server.html#configuration">Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="qgis-server.html#deployment">Deployment</a></li>
<li class="toctree-l3"><a class="reference internal" href="qgis-server.html#enabling">Enabling</a></li>
<li class="toctree-l3"><a class="reference internal" href="qgis-server.html#disabling">Disabling</a></li>
<li class="toctree-l3"><a class="reference internal" href="qgis-server.html#accessing-the-running-services">Accessing the running services</a></li>
<li class="toctree-l3"><a class="reference internal" href="qgis-server.html#additional-notes">Additional Notes</a></li>
<li class="toctree-l3"><a class="reference internal" href="qgis-server.html#further-reading">Further Reading</a></li>
<li class="toctree-l3"><a class="reference internal" href="qgis-server.html#qgis-server-atlas-print-plugin">QGIS Server Atlas Print Plugin</a></li>
<li class="toctree-l3"><a class="reference internal" href="qgis-server.html#qgis-server-scaling">QGIS Server Scaling</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="scp.html">SCP</a><ul>
<li class="toctree-l3"><a class="reference internal" href="scp.html#configuration">Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="scp.html#deployment">Deployment</a></li>
<li class="toctree-l3"><a class="reference internal" href="scp.html#enabling">Enabling</a></li>
<li class="toctree-l3"><a class="reference internal" href="scp.html#disabling">Disabling</a></li>
<li class="toctree-l3"><a class="reference internal" href="scp.html#accessing-the-running-services">Accessing the running services</a></li>
<li class="toctree-l3"><a class="reference internal" href="scp.html#additional-notes">Additional Notes</a></li>
<li class="toctree-l3"><a class="reference internal" href="scp.html#scp-file-drop-shares">SCP File Drop Shares</a></li>
<li class="toctree-l3"><a class="reference internal" href="scp.html#directory-layout-for-the-qgis-projects-folder">Directory layout for the QGIS projects folder</a></li>
<li class="toctree-l3"><a class="reference internal" href="scp.html#starting-the-container">Starting the container</a></li>
<li class="toctree-l3"><a class="reference internal" href="scp.html#faq">FAQ</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="index.html#indices-and-tables">Indices and tables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation/index.html#installation">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../installation/server_preparation.html#preparing-the-server">Preparing the server</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../installation/server_preparation.html#basic-security">Basic Security</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../installation/server_preparation.html#unattended-upgrades">Unattended upgrades</a></li>
<li class="toctree-l4"><a class="reference internal" href="../installation/server_preparation.html#ssh">ssh</a></li>
<li class="toctree-l4"><a class="reference internal" href="../installation/server_preparation.html#crowdsec">Crowdsec</a></li>
<li class="toctree-l4"><a class="reference internal" href="../installation/server_preparation.html#fail2ban">Fail2ban</a></li>
<li class="toctree-l4"><a class="reference internal" href="../installation/server_preparation.html#firewall">Firewall</a></li>
<li class="toctree-l4"><a class="reference internal" href="../installation/server_preparation.html#status-monitoring">Status monitoring</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../installation/server_preparation.html#additional-software">Additional Software</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../installation/server_preparation.html#docker">Docker</a></li>
<li class="toctree-l4"><a class="reference internal" href="../installation/server_preparation.html#git-rpl-pwgen-and-make-openssl">Git, rpl, pwgen and Make. openssl</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../installation/initial_configuration.html#initial-configuration">Initial Configuration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../installation/initial_configuration.html#user-group">User Group</a></li>
<li class="toctree-l3"><a class="reference internal" href="../installation/initial_configuration.html#project-checkout">Project Checkout</a></li>
<li class="toctree-l3"><a class="reference internal" href="../installation/initial_configuration.html#fetching-docker-images">Fetching Docker Images</a></li>
<li class="toctree-l3"><a class="reference internal" href="../installation/initial_configuration.html#configuration">Configuration</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../installation/fonts.html#obtaining-free-fonts-for-your-projects">Obtaining free fonts for your projects</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation/production_stack.html#production-stack">Production Stack</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../installation/production_stack.html#overview">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="../installation/production_stack.html#configuration">Configuration</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../installation/index.html#indices-and-tables">Indices and tables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../utilities/index.html">Utilities</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../utilities/make-ps.html">make ps</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../utilities/make-ps.html#synopsis">Synopsis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../utilities/make-ps.html#usage">Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../utilities/make-ps.html#notes">Notes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../utilities/make-kill.html">make kill</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../utilities/make-kill.html#synopsis">Synopsis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../utilities/make-kill.html#usage">Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../utilities/make-kill.html#notes">Notes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../utilities/make-nuke.html">make nuke</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../utilities/make-nuke.html#synopsis">Synopsis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../utilities/make-nuke.html#usage">Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../utilities/make-nuke.html#notes">Notes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../utilities/building_docs.html">Building Documentation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../utilities/building_docs.html#html-docs">HTML Docs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../utilities/building_docs.html#pdf-docs">PDF Docs</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../utilities/index.html#indices-and-tables">Indices and tables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../workflows/index.html">Workdlows</a><ul class="simple">
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../workflows/index.html#indices-and-tables">Indices and tables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../osm.html#osm-mirror">OSM Mirror</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../osm.html#pbf-container">PBF Container</a></li>
<li class="toctree-l2"><a class="reference internal" href="../osm.html#clip-area">Clip Area</a></li>
<li class="toctree-l2"><a class="reference internal" href="../osm.html#mappings">Mappings</a></li>
<li class="toctree-l2"><a class="reference internal" href="../osm.html#run-services">Run services</a></li>
<li class="toctree-l2"><a class="reference internal" href="../osm.html#publishing-with-geoserver">Publishing with GeoServer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../osm.html#publishing-with-qgis-server">Publishing with QGIS Server</a></li>
<li class="toctree-l2"><a class="reference internal" href="../osm.html#osm-attribution">OSM Attribution</a></li>
</ul>
</li>
</ul>

  
          </div>
          <div class="body">
            
  <div class="tex2jax_ignore mathjax_ignore section" id="postgres-and-postgis">
<h1>Postgres and PostGIS<a class="headerlink" href="#postgres-and-postgis" title="Permalink to this headline">¶</a></h1>
<p>Short description</p>
<p><strong>Project Website:</strong> <a class="reference external" href="https://postgresql.org">PostgreSQL</a> and <a class="reference external" href="https://postgis.net/">PostGIS</a></p>
<p><strong>Project Source Repository:</strong></p>
<p><strong>Project Project Technical Documentation:</strong></p>
<p><strong>Docker Repository:</strong></p>
<p><strong>Docker Source Repository:</strong></p>
<div class="section" id="configuration">
<h2>Configuration<a class="headerlink" href="#configuration" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="deployment">
<h2>Deployment<a class="headerlink" href="#deployment" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="enabling">
<h2>Enabling<a class="headerlink" href="#enabling" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="disabling">
<h2>Disabling<a class="headerlink" href="#disabling" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="accessing-the-running-services">
<h2>Accessing the running services<a class="headerlink" href="#accessing-the-running-services" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="additional-notes">
<h2>Additional Notes<a class="headerlink" href="#additional-notes" title="Permalink to this headline">¶</a></h2>
<p>The heart of any stack like this would be PostGIS and PostgreSQL. This is because many
of the other tools provided in the OSGS stack, for example Goeserver, QGIS Server and
Mergin, all rely or can make use of PostGIS as a data storage platform and in some cases
as a data anlysis platform. The OSGS stack provides  PostgreSQL version 13 along with
PostGIS which are provided by the the Kartoza PostGIS Docker container. There are a few
considerations that were made when deploying this container. One, which is actually a
general design consideration of the OSGS stack, is to try and make everything as secure
as possible out of the box, rather than leaving security as an afterthought. To fulfill
this consideration, what the OSGS stack does, is it spins up a PostgreSQL instance with
PostGIS deployed in it and creates a separate user account for connecting to this instance.
It also enables SSL encription by default, as required to the PostgreSQL database. This
is so that if you choose to open the port as a public service, firstly, we are not using
some well documented default password and username combination and secondly, all the traffic
between your client application and the server is encrypted.</p>
</div>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>We use the Kartoza PostGIS docker image available here:
https://hub.docker.com/r/kartoza/postgis/</p>
<p>The project home page is here: https://github.com/kartoza/docker-postgis</p>
<p>The project includes detailed documentation so this section only contains
details relevant to the Open Source GIS Stack configuration.</p>
</div>
<div class="section" id="id1">
<h2>Configuration<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<div class="section" id="database-password">
<h3>Database password:<a class="headerlink" href="#database-password" title="Permalink to this headline">¶</a></h3>
<p>Generate a strong password:</p>
<p><code class="docutils literal notranslate"><span class="pre">pwgen</span> <span class="pre">20</span>&#160; <span class="pre">1</span></code></p>
<p>Replace the default docker password for the postgres user with the strong
password:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>rpl “POSTGRES_PASSWORD=docker” “POSTGRES_PASSWORD=&lt;strong password&gt;” .env
</pre></div>
</div>
</div>
<div class="section" id="service-file-configuration">
<h3>Service file configuration:<a class="headerlink" href="#service-file-configuration" title="Permalink to this headline">¶</a></h3>
<p>Service files entries serve two scenarios:</p>
<ol class="simple">
<li>They are needed for opening QGIS projects stored in postgres with PG
connection URI because at the project URI you cannot use QGIS authdb. If you
prefer to store your projects on the file system, you should rather remove
these lines (whole nginx section) since the authentication from
pg_conf/pg_service.conf can be done more securely by QGIS authdb.</li>
<li>Used by your QGIS Server projects to connect to the database once the
project is opened from either the file system of the database.  You can
either specify your password and username in service file or for more advanced
configuration you can store user / password credentials in a QGIS authdb file.
Refer to the authdb section and in qgis_conf/qgis-auth.db and the readme in
that folder.</li>
</ol>
<p>On your local machine you should create your own service file with the same
service name but connection details that make sense when using the database
from your local machine. When you upload your projects into the stack they will
connect using the settings from the server hosted service file below assuming
you used the same service name.</p>
<p>To carry out the service file configuration, copy, rename then edit the
pg_service file in pg_config as per the example below (note that we also
substitute in the database password created in the steps above).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cp</span> <span class="n">pg_conf</span><span class="o">/</span><span class="n">pg_service</span><span class="o">.</span><span class="n">conf</span><span class="o">.</span><span class="n">example</span> \ <span class="n">pg_conf</span><span class="o">/</span><span class="n">pg_service</span><span class="o">.</span><span class="n">confpassword</span><span class="o">=</span><span class="n">docker</span> 
<span class="n">rpl</span> <span class="n">password</span><span class="o">=&lt;</span><span class="n">your</span> <span class="n">password</span><span class="o">&gt;</span> <span class="n">pg_conf</span><span class="o">/</span><span class="n">pg_service</span><span class="o">.</span><span class="n">conf</span>
</pre></div>
</div>
</div>
<div class="section" id="id2">
<h3>Deployment<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">docker</span><span class="o">-</span><span class="n">compose</span> <span class="o">--</span><span class="n">profile</span><span class="o">=</span><span class="n">postgres</span> <span class="n">up</span> <span class="o">-</span><span class="n">d</span>
</pre></div>
</div>
<p>Note that the default configuration opens the postgresql service to all hosts.
This is a potential security hole. If you open the port on the firewall e.g.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ufw</span> <span class="n">allow</span> <span class="mi">5432</span> <span class="n">tcp</span>
</pre></div>
</div>
<p>Then be sure to connect from pg clients like psql or QGIS with SSL enabled so
that passwords and data are not transmitted in clear text.</p>
</div>
<div class="section" id="validation">
<h3>Validation<a class="headerlink" href="#validation" title="Permalink to this headline">¶</a></h3>
<p>Create a local pg_service.conf file like the example below and save it in
<code class="docutils literal notranslate"><span class="pre">~/.pg_service.conf</span></code> or similar as appropriate to your operating system (see
https://www.postgresql.org/docs/12/libpq-pgservice.html for details on
configuration options).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">os</span><span class="o">-</span><span class="n">gis</span><span class="o">-</span><span class="n">stack</span><span class="p">]</span>
<span class="n">dbname</span><span class="o">=</span><span class="n">gis</span>
<span class="n">port</span><span class="o">=</span><span class="mi">5432</span>
<span class="n">host</span><span class="o">=&lt;</span><span class="n">hostname</span> <span class="n">of</span> <span class="n">your</span> <span class="n">server</span><span class="o">&gt;</span>
<span class="n">user</span><span class="o">=&lt;</span><span class="n">your</span> <span class="n">password</span><span class="o">&gt;</span>
<span class="n">password</span><span class="o">=</span><span class="n">docker</span>
</pre></div>
</div>
<p>Now pass the server parameter to psql and list the databases as per the example
below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>[timlinux@fedora ~]$ psql service=os-gis-stack -l
List of databases
</pre></div>
</div>
<table class="colwidths-auto">
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Owner</th>
<th class="head">Encoding</th>
<th class="head">Collate</th>
<th class="head">Ctype</th>
<th class="head">Access privileges</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>gis</td>
<td>docker</td>
<td>UTF8</td>
<td>C.UTF-8</td>
<td>C.UTF-8</td>
<td></td>
</tr>
<tr class="row-odd"><td>postgres</td>
<td>postgres</td>
<td>UTF8</td>
<td>C.UTF-8</td>
<td>C.UTF-8</td>
<td></td>
</tr>
<tr class="row-even"><td>template0</td>
<td>postgres</td>
<td>UTF8</td>
<td>C.UTF-8</td>
<td>C.UTF-8</td>
<td>=c/postgres</td>
</tr>
<tr class="row-odd"><td>template1</td>
<td>postgres</td>
<td>UTF8</td>
<td>C.UTF-8</td>
<td>C.UTF-8</td>
<td>=c/postgres</td>
</tr>
</tbody>
</table>
<p><code class="docutils literal notranslate"><span class="pre">(4</span> <span class="pre">rows)</span></code></p>
<p>Test from QGIS is similar:</p>
<p>XXXXXXXXXXXXXX</p>
<p>Note that there was no need to supply any credentials other than the service file name.</p>
</div>
</div>
<div class="section" id="postgresql-workflows">
<h2>PostgreSQL Workflows<a class="headerlink" href="#postgresql-workflows" title="Permalink to this headline">¶</a></h2>
<p>There are a number of different workflows we will explore here:</p>
<ul class="simple">
<li>Connecting to the PostgreSQL database from your QGIS Desktop application</li>
<li>Connecting to the PostgreSQL database from QGIS Server</li>
<li>Connecting to the PostgreSQL database from GeoServer</li>
<li>Connecting from other applications</li>
</ul>
<p>Before we dive into the details here, let us quickly examine some basic use cases:</p>
<ul class="simple">
<li>You collect data in the field using Input and use the mergin-db-sync workflow to synchronised field collected data into the database, then publish maps for this data in QGIS Server.</li>
<li>You want to publish a layer in GeoServer, so you connect to the database from your desktop, drag and drop a local file system layer into the database using QGIS, then publish the layer from GeoServer.</li>
<li>You want to create a project in QGIS desktop that uses PostgreSQL for data storage, then publish that data as a QGIS Project.</li>
</ul>
<p>There are many other workflows that the Open GIS Stack supports, it is really up to your imagination! What is key to understand are the mechanisms that you can use to connect to the database in different contexts. And so we will focus this section on the different connection modalities.</p>
<div class="section" id="direct-connection">
<h3>Direct connection<a class="headerlink" href="#direct-connection" title="Permalink to this headline">¶</a></h3>
<p>Direct connection to the server over the standard PostgreSQL port exposed to the public internet is probably the least secure but most convenient approach. We do not recommend this approach, and if you do follow it be sure to use the option to force remote clients to connect using SSL (and expect a performance penalty in the process).</p>
<p>Note also that connecting to a PostgreSQL database using QGIS from a remote host may often be slow and irritating to use on a daily basis, especially if your internet connection is not very fast and your datasets are large.</p>
<p>By default the docker-compose.yaml</p>
<p>Publishing with QGIS Server</p>
<p>The workflows described in this section apply equally to any database hosted</p>
<p>Further reading for understanding authentication with PostgreSQL using cert based authentication here:</p>
<p>https://joelonsql.com/2013/04/27/securing-postgresql-using-hostssl-cert-clientcert1/</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
    </div>
  </div>
  <div id="footer-row" class="row">

    <div class="col-md-12">
        <span></span><span class="pull-right">&copy; Copyright 2021, Tim Sutton.
        Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.1.2 and the
        <a href="https://pypi.org/project/sphinx-sizzle-theme/"

           title="0.0.9/821a5457 [2020-04-16T19:31:16]"

        >Sizzle</a> theme.</span>
    </div>

  </div>
</div>

<div id="tooltips" class="hidden">
</div>

<script>
$(document).ready(function() {
  'use strict';
  var $search = $('.search-query');

  var $filter = $('#toc-filter-query');
  var $toclist = $('.sidebar-toc > ul').find('li');

  if ($toclist.length === 0) {
    $toclist = $('.localtoc > ul').find('li');
  }


  var $nav = $('#nav');

  //$('#whole-page').removeClass('hidden');
  var nav_width = $nav.width();


  var search_url = '../search.html';

  function perform_search(e) {
    var $elem;

    if (e.type === 'keypress') {
      $elem = $(e.target);
    }
    else if (e.type === 'click') {
      $elem = $(e.target).parents('.input-group').find('input');
    }
    var q = $elem.val().trim();

    if (q) {
      var url = search_url + '?q=' + q + '&check_keywords=yes&area=default';

      location.href = url;
    }
  }


  function apply_filter() {
    var s = $filter.val().trim().toLowerCase();

    $toclist.find('a').removeClass('hidden');
    $toclist.each(function() {
      var $this = $(this);
      var $link = $this.find('> a');
      var t = $link.text().toLowerCase();
      var show = t.indexOf(s) >= 0;

      if (!show) {
        $link.addClass('hidden');
      }
    });
  }

  $filter.on('keyup', function(e) {
    apply_filter();
  });



  $search.on('keypress', function(e) {
    if (e.which == 13) {
      perform_search(e);
    }
  });
  $search.parents('.input-group').find('.input-group-addon').on('click', perform_search);
  $(document).on('click', '.summary .fa-caret-right', function(e) {
    var $elem = $(e.target).parents('li');
    var $next = $elem.next();
    $elem.addClass('hidden');
    $next.removeClass('hidden');
  });
  $(document).on('click', '.detail .fa-caret-down', function(e) {
    var $elem = $(e.target).parents('li');
    var $prev = $elem.prev();
    $elem.addClass('hidden');
    $prev.removeClass('hidden');
  });

  $('#content').on('click', function() {
    $('#mnav').hide();
  });

  var counter = 0;
  var timer = null;

  function show_nav() {
    $('#content').off('mousemove', track_mouse);
    if (timer !== null) {
      clearTimeout(timer);
      timer = null;
    }
    $nav.show();
  }

  function track_mouse(e) {
    var x = e.clientX;

    if (x < 15) {
      ++counter;
      if (timer === null) {
        timer = setTimeout(show_nav, 2000);
      }
    }
    else {
      counter = 0;
    }
    if (counter >= 20) {
      show_nav();
    }
  };

  function hide_nav() {
    $nav.hide();
    counter = 0;
    $('#content').on('mousemove', track_mouse);
  }

  $('.hidetoc').on('click', hide_nav);

  $(document).on('keyup', function(e) {
    if (e.ctrlKey) {
      if (e.which == 37) {      // Ctrl+left arrow
        hide_nav();
      }
      else if (e.which == 39) { // Ctrl+right arrow
        show_nav();
      }
    }
  });

  $('.menu-toggle').on('click', function(e) {
    $('#mnav').toggle();
  });

  function scroll_nav(frag) {
    var sel = '#nav ' + (frag ? 'a[href="' + frag + '"]' : '.toctree-l1 a.current');

    var $link = $(sel);

    if ($link.length > 0) {
      $link[0].scrollIntoView({block: 'center'});
    }
  }

  // If the navigator is long, then the item we clicked on to get here might
  // not be in view. Try to scroll it into the view - a slight delay is needed
  // to get it to sync properly with other stuff going on (as the page has just
  // loaded). Hence the setTimeout with a timeout of 0.

  function do_scroll() {
    scroll_nav(window.location.hash);
  }

  setTimeout(do_scroll, 0);

  function adjust_size() {
    // we need to set the height explicitly so that scrolling regions in the
    // content area work properly.
    var h = $('#page-content').height();

    $('#nav, #content').height(h);
    if ($('#nav').is(':visible')) {
      $('#mnav').hide();
    }
  }

  adjust_size();

  $(window).on('resize', adjust_size);

  function focus_content() {
    $('#content').focus();  // so that keyboard can be used to scroll, etc.
  }

  setTimeout(focus_content, 150);

  var sizzle = $(document).data('sizzle');

  function make_tooltip(id, h, b) {
    var $e = $('<div>').attr('id', id);
    var $b = $('<div>').addClass('tc-body').html(b);

    if (h) {
      var $h = $('<div>').addClass('tc-heading').html(h);
      $e.append($h);
    }
    $e.append($b);
    return $e;
  }

  var default_tt_options = {
    theme: ['tooltipster-light', 'tooltipster-light-customized'],
    interactive: true,
    maxWidth: 600,
    contentCloning: true
  };

  function activate_tooltips() {
    var $tt = $('.tt');

    //console.log('tt links:', $tt.length);
    $tt.tooltipster(default_tt_options);
  }



  function add_glossary_tooltips() {
    var links = $('a');  // can qualify with .reference.internal
    var glinks = {};
    var pat = /(.*)\.html#(term-.*)$/;
    var found = false;  // links in this document

    $.each(links, function(i, link) {
        var $link = $(link);
        var href = $link.attr('href');
        var m = href.match(pat);

        if (m) {
          var s = m[1].replace(/^(\.\.\/)+/, '');

          if (s === sizzle.app_data.glossary.document) {
            var k = m[2];

            if (k in glinks) {
              glinks[k].push($link);
            }
            else {
              glinks[k] = [$link];
            }
            found = true;
          }
        }
    });
    if (found) {
      var $t = $('#tooltips');
      var data = sizzle.app_data.glossary.terms;

      $.each(glinks, function(k, v) {
        var d = data[k];

        if (d) {  // as a sanity check
          var s = 'tc-'+ k;
          var $e = make_tooltip(s, d.term, d.defn);
          $t.append($e);

          $.each(v, function(i, link) {
            link.addClass('tt').attr('data-tooltip-content', '#' + s);
          });
        }
      });
    }
  }

  if (sizzle.app_data && sizzle.app_data.glossary &&
      sizzle.app_data.glossary.document) {
    add_glossary_tooltips();
  }




  function add_custom_tooltips() {
    var info_tips = sizzle.app_data.custom_data['info-tips'] || {};

    if ($.isEmptyObject(info_tips)) {
      return;
    }

    var tt_options = $.extend({contentAsHTML: true}, default_tt_options);

    $('.tc-info').each(function() {
      var $elem = $(this).prev();
      var classes = $elem.attr('class');
      var m = /\btci-([\S]+)/.exec(classes);

      if (m !== null) {
        var key = m[1];

        if (key in info_tips) {
          var v = info_tips[key];
          var tt = $elem.tooltipster(tt_options).tooltipster('content', v);
        }
      }
    });
  }

  add_custom_tooltips();

  setTimeout(activate_tooltips, 1000);


  // Clipboard copy for code blocks with captions

  $('.code-block-caption').each(function() {
    var $cap = $(this);
    var $btn = $('<span class="clip-copy"><span class="copied hidden">Copied!</span><i class="fa fa-clipboard" title="Copy contents"></i></span>');
    var $code = $cap.parent().find('.highlight');

    $cap.append($btn);
    $btn.find('.fa-clipboard').data('clip-text', $code.text());
  });

  var clipboard = new ClipboardJS('.code-block-caption .fa-clipboard', {
    'text': function(trigger) {
      return $(trigger).data('clip-text');
    }
  });

  clipboard.on('success', function(e) {
    var $copied = $(e.trigger).prev();

    $copied.removeClass('hidden');

    setTimeout(function() {$copied.addClass('hidden'); }, 1000);
  });

  if (sizzle.on_load) {
    sizzle.on_load.forEach(function(f) {
      f();
    });
  }
});
</script>
</body>
</html>